# CHÆ¯Æ NG 4: CÆ M-Má»ªN

"_Äá»«ng biáº¿n Ä‘á»‘ng code gá»›m ghiáº¿c cá»§a báº¡n thÃ nh comment - hÃ£y viáº¿t láº¡i nÃ³"_  
*- Brian W. Kernighan and P. J. Plaugher*

KhÃ´ng gÃ¬ há»¯u Ã­ch báº±ng má»™t comment Ä‘Æ°á»£c Ä‘áº·t Ä‘Ãºng chá»•. KhÃ´ng gÃ¬ cÃ³ thá»ƒ lÃ m lá»™n xá»™n Ä‘á»‘ng code cá»§a báº¡n, ngoáº¡i trá»« nhá»¯ng comment ngu xuáº©n vÃ  dá»‘i trÃ¡. VÃ  khÃ´ng gÃ¬ cÃ³ thá»ƒ gÃ¢y nguy hiá»ƒm báº±ng má»™t comment cá»™c lá»‘c tá»« Ä‘á»i nÃ o vÃ  láº¡i khÃ´ng Ä‘Ãºng sá»± tháº­t.

CÃ¡c comment khÃ´ng pháº£i lÃ  _Báº£n danh sÃ¡ch cá»§a Schindler_ (Schindler's List â€“ [https://en.wikipedia.org/wiki/Schindler's_List](https://en.wikipedia.org/wiki/Schindler%27s_List). ChÃºng khÃ´ng tá»‘t hoÃ n toÃ n nhÆ° báº¡n nghÄ©. CÃ¡c comment, tá»‘t nháº¥t, nÃªn trá»Ÿ thÃ nh sá»± lá»±a chá»n cuá»‘i cÃ¹ng. Náº¿u ngÃ´n ngá»¯ láº­p trÃ¬nh cá»§a chÃºng ta cÃ³ Ä‘áº§y Ä‘á»§ kháº£ nÄƒng diá»…n Ä‘áº¡t, hoáº·c náº¿u chÃºng ta cÃ³ Ä‘á»§ tÃ i nÄƒng sá»­ dá»¥ng code Ä‘á»ƒ thá»ƒ hiá»‡n háº¿t Ã½ Ä‘á»‹nh cá»§a mÃ¬nh thÃ¬ chÃºng ta Ä‘Ã£ khÃ´ng cáº§n Ä‘áº¿n nhá»¯ng dÃ²ng comment.

Viá»‡c dÃ¹ng Ä‘Ãºng cÃ¡c comment lÃ  má»™t cÃ¡ch Ä‘á»ƒ bÃ¹ Ä‘áº¯p cho sá»± tháº¥t báº¡i cá»§a chÃºng ta trong viá»‡c thá»ƒ hiá»‡n Ã½ nghÄ©a cá»§a nhá»¯ng dÃ²ng code. HÃ£y lÆ°u Ã½ ráº±ng tÃ´i Ä‘Ã£ dÃ¹ng tá»« tháº¥t báº¡i. ChÃ­nh xÃ¡c lÃ  váº­y â€“ comment luÃ´n luÃ´n lÃ  sá»± tháº¥t báº¡i. ChÃºng ta pháº£i cÃ³ chÃºng vÃ¬ chÃºng ta khÃ´ng thá»ƒ thá»ƒ hiá»‡n háº¿t Ã½ nghÄ©a cá»§a code, vÃ  viá»‡c sá»­ dá»¥ng chÃºng khÃ´ng pháº£i lÃ  nguyÃªn nhÃ¢n Ä‘Æ°á»£c tÃ¡n dÆ°Æ¡ng.

Váº­y nÃªn, khi báº¡n tháº¥y mÃ¬nh cáº§n viáº¿t comment, hÃ£y suy nghÄ© ká»¹ xem liá»‡u cÃ³ cÃ¡ch nÃ o Ä‘Ã³ Ä‘á»ƒ biáº¿n cÃ¡c dÃ²ng code thÃ nh chÃ­nh xÃ¡c nhá»¯ng gÃ¬ báº¡n muá»‘n thá»ƒ hiá»‡n hay khÃ´ng. Má»—i khi báº¡n thá»ƒ hiá»‡n chÃ­nh xÃ¡c Ã½ nghÄ©a cá»§a code, hÃ£y tá»± khÃ­ch lá»‡ mÃ¬nh. Má»—i khi báº¡n viáº¿t comment, báº¡n nÃªn tá»± váº£ vÃ o máº·t cho sá»± tháº¥t báº¡i Ä‘Ã³ .

Táº¡i sao tÃ´i láº¡i tháº¥t vá»ng vá» cÃ¡c comment? VÃ¬ chÃºng Ä‘áº§y dá»‘i trÃ¡. KhÃ´ng pháº£i lÃºc nÃ o cÅ©ng váº­y, nhÆ°ng váº¥n Ä‘á» nÃ y láº¡i ráº¥t thÆ°á»ng xuyÃªn xÃ£y ra: Comment cÃ ng cÅ© vÃ  cÃ ng khÃ´ng liÃªn quan tá»›i code mÃ  nÃ³ mÃ´ táº£, cÃ ng cÃ³ nhiá»u kháº£ nÄƒng nÃ³ sai. LÃ½ do ráº¥t Ä‘Æ¡n giáº£n, cÃ¡c láº­p trÃ¬nh viÃªn khÃ´ng thá»ƒ báº£o trÃ¬ chÃºng.

Code cá»§a dá»± Ã¡n thÃ¬ thay Ä‘á»•i vÃ  phÃ¡t triá»ƒn liÃªn tá»¥c. CÃ¡c khá»‘i dá»¯ liá»‡u di chuyá»ƒn tá»« nÆ¡i nÃ y Ä‘áº¿n nÆ¡i kia. Nhá»¯ng khá»‘i Ä‘Ã³ tÃ¡ch ra vÃ  tÃ¡i láº­p Ä‘á»ƒ táº¡o nÃªn chÆ°Æ¡ng trÃ¬nh. Tháº­t khÃ´ng may, nhá»¯ng comment khÃ´ng pháº£i lÃºc nÃ o cÅ©ng theo ká»‹p chÃºng. Comment thÃ¬ thÆ°á»ng xuyÃªn bá»‹ tÃ¡ch ra khá»i code mÃ  nÃ³ mÃ´ táº£ vÃ  trá»Ÿ nÃªn Ä‘á»©t Ä‘oáº¡n vá»›i Ä‘á»™ chÃ­nh xÃ¡c giáº£m dáº§n. VÃ­ dá»¥, hÃ£y xem nhá»¯ng gÃ¬ xÃ£y ra vá»›i comment nÃ y vÃ  dÃ²ng code mÃ  nÃ³ dá»± Ä‘á»‹nh mÃ´ táº£:

```java
MockRequest request;
private final String HTTP_DATE_REGEXP =
 "[SMTWF][a-z]{2}\\,\\s[0-9]{2}\\s[JFMASOND][a-z]{2}\\s"+
 "[0-9]{4}\\s[0-9]{2}\\:[0-9]{2}\\:[0-9]{2}\\sGMT";
private Response response;
private FitNesseContext context;
private FileResponder responder;
private Locale saveLocale;
// Example: "Tue, 02 Apr 2003 22:18:49 GMT"
```

CÃ¡c biáº¿n khÃ¡c cÃ³ thá»ƒ Ä‘Æ°á»£c thÃªm vÃ o sau Ä‘Ã³ Ä‘áº·t xen káº½ vÃ o giá»¯a giÃ¡ trá»‹ HTTP\_DATE\_REGEXP. GiÃ¡ trá»‹ HTTP\_DATE\_REGEXP Ä‘Æ°á»£c viáº¿t láº¡i vÃ  comment cá»§a báº¡n thÃ¬ tan nÃ¡t. ğŸ™‚

CÃ³ quan Ä‘iá»ƒm cho ráº±ng cÃ¡c láº­p trÃ¬nh viÃªn nÃªn cÃ³ Ä‘á»§ ká»· luáº­t Ä‘á»ƒ sá»­a cáº£ nhá»¯ng dÃ²ng comment khi há» Ä‘Ã£ thay Ä‘á»•i code. TÃ´i Ä‘á»“ng Ã½, há» nÃªn nhÆ° tháº¿. NhÆ°ng tÃ´i sáº½ chá»n cÃ¡ch lÃ m cho code rÃµ rÃ ng dá»… hiá»ƒu, Ä‘áº¿n má»©c nÃ³ khÃ´ng cáº§n cÃ¡c comment ngay tá»« Ä‘áº§u.

Nhá»¯ng dÃ²ng comment báº­y cÃ²n tá»“i tá»‡ hÆ¡n lÃ  khÃ´ng comment. ChÃºng lá»«a gáº¡t vÃ  Ä‘Ã¡nh láº¡c hÆ°á»›ng ngÆ°á»i Ä‘á»c. ChÃºng Ä‘Æ°a ra nhá»¯ng dá»± tÃ­nh khÃ´ng bao giá» Ä‘Æ°á»£c thá»±c hiá»‡n. ChÃºng Ä‘áº·t ra nhá»¯ng quy táº¯c cÅ©, khÃ´ng cáº§n, hoáº·c khÃ´ng nÃªn Ä‘Æ°á»£c tuÃ¢n theo ná»¯a.

ChÃ¢n lÃ½ chá»‰ cÃ³ thá»ƒ tÃ¬m tháº¥y táº¡i má»™t nÆ¡i duy nháº¥t: Code. Chá»‰ cÃ³ code má»›i nÃ³i cho báº¡n biáº¿t tháº­t sá»± nhá»¯ng gÃ¬ nÃ³ lÃ m. NÃ³ lÃ  nguá»“n thÃ´ng tin chÃ­nh xÃ¡c duy nháº¥t. Do Ä‘Ã³, máº·c dÃ¹ comment Ä‘Ã´i khi lÃ  cáº§n thiáº¿t, nhÆ°ng chÃºng tÃ´i sáº½ cá»‘ gáº¯ng Ä‘á»ƒ giáº£m thiá»ƒu nÃ³.

## Äá»«ng dÃ¹ng comment Ä‘á»ƒ lÃ m mÃ u cho code

Má»™t trong nhá»¯ng Ä‘á»™ng lá»±c to lá»›n Ä‘á»ƒ viáº¿t comment lÃ  do code tá»“i, code tá»‘i nghÄ©a. ChÃºng ta viáº¿t má»™t hÃ m vÃ  chÃºng ta biáº¿t nÃ³ khÃ³ hiá»ƒu, nÃ³ vÃ´ tá»• chá»©c, chÃºng ta biáº¿t nÃ³ lÃ  má»™t Ä‘á»‘ng há»— lá»‘n. Váº­y nÃªn chÃºng ta tá»± nhá»§ ráº±ng: "á»’, tá»‘t hÆ¡n nÃªn viáº¿t comment á»Ÿ Ä‘Ã¢y!". KhÃ´ng! Tá»‘t hÆ¡n báº¡n nÃªn viáº¿t láº¡i code!

Code sÃ¡ng nghÄ©a vÃ  rÃµ rÃ ng vá»›i Ã­t comment sáº½ tuyá»‡t vá»i hÆ¡n so vá»›i code tá»‘i nghÄ©a, phá»©c táº¡p vá»›i nhiá»u comment. Thay vÃ¬ dÃ nh thá»i gian Ä‘á»ƒ viáº¿t comment giáº£i thÃ­ch má»› code há»— lá»‘n Ä‘Ã³, hÃ£y dÃ nh thá»i gian Ä‘á»ƒ dá»n dáº¹p nÃ³.

## Giáº£i thÃ­ch Ã½ nghÄ©a ngay trong code

Cháº¯c cháº¯n cÃ³ nhá»¯ng lÃºc code cá»§a báº¡n ráº¥t khÃ³ Ä‘á»ƒ giáº£i thÃ­ch nÃ³ Ä‘ang lÃ m gÃ¬. Tháº­t khÃ´ng may, Ä‘iá»u nÃ y lÃ m cho nhiá»u láº­p trÃ¬nh viÃªn cho ráº±ng code hiáº¿m khi lÃ  má»™t cÃ¡ch tá»‘t Ä‘á»ƒ giáº£i thÃ­ch. Äiá»u Ä‘Ã³ hoÃ n toÃ n sai. Báº¡n muá»‘n nhÃ¬n tháº¥y Ä‘iá»u gÃ¬? CÃ¡i nÃ y:

```java
// Check to see if the employee is eligible for full benefits
if ((employee.flags & HOURLY_FLAG) && 
(employee.age > 65))
```

Hay cÃ¡i nÃ y?

```java
if (employee.isEligibleForFullBenefits())
```

Chá»‰ máº¥t vÃ i giÃ¢y suy nghÄ© Ä‘á»ƒ truyá»n háº¿t thÃ´ng Ä‘iá»‡p cá»§a báº¡n vÃ o code. Trong nhiá»u trÆ°á»ng há»£p, nÃ³ chá»‰ Ä‘Æ¡n giáº£n lÃ  táº¡o ra má»™t hÃ m cÃ³ tÃªn giá»‘ng vá»›i comment mÃ  báº¡n muá»‘n viáº¿t

## Good Comments

Má»™t sá»‘ comment lÃ  cáº§n thiáº¿t hoáº·c cÃ³ Ã­ch. ChÃºng ta sáº½ xem xet má»™t vÃ i trÆ°á»ng há»£p mÃ  tÃ´i cho lÃ  xá»©ng Ä‘Ã¡ng Ä‘á»ƒ báº¡n bá» cÃ´ng ra viáº¿t. Tuy nhiÃªn, hÃ£y nhá»› ráº±ng comment tháº­t sá»± tá»‘t lÃ  comment khÃ´ng cáº§n pháº£i viáº¿t ra.

### Comment phÃ¡p lÃ½

ÄÃ´i khi cÃ¡c tiÃªu chuáº©n mÃ£ hÃ³a doanh nghiá»‡p buá»™c chÃºng ta pháº£i viáº¿t má»™t sá»‘ comment nháº¥t Ä‘á»‹nh vÃ¬ lÃ½ do phÃ¡p lÃ½. VÃ­ dá»¥, tuyÃªn bá»‘ báº£n quyá»n vÃ  quyá»n tÃ¡c giáº£ lÃ  nhá»¯ng Ä‘iá»u cáº§n thiáº¿t vÃ  há»£p lÃ½ Ä‘á»ƒ Ä‘Æ°a vÃ o comment khi báº¯t Ä‘áº§u má»—i source code file.

```java
/* Copyright (C) 2003,2004,2005 by Object Mentor, Inc.
 * All rights reserved. 
 * Released under the terms of the GNU General Public License version
 * 2 or later.
 */
```

Äá»«ng Ä‘Æ°a cáº£ há»£p Ä‘á»“ng hay nhá»¯ng Ä‘iá»u luáº­t vÃ o comment. Náº¿u cÃ³ thá»ƒ, hÃ£y tham kháº£o má»™t vÃ i giáº¥y phÃ©p tiÃªu chuáº©n hay tÃ i liá»‡u bÃªn ngoÃ i khÃ¡c thay vÃ¬ Ä‘Æ°a táº¥t cáº£ nhá»¯ng Ä‘iá»u khoáº£n vÃ  Ä‘iá»u kiá»‡n vÃ o.

### Comment cung cáº¥p thÃ´ng tin

Cung cáº¥p thÃ´ng tin cÆ¡ báº£n vá»›i má»™t vÃ i dÃ²ng comment Ä‘Ã´i khi ráº¥t há»¯u Ã­ch. VÃ­ dá»¥, hÃ£y xem cÃ¡ch mÃ  comment nÃ y giáº£i thÃ­ch vá» giÃ¡ trá»‹ tráº£ vá» cá»§a má»™t phÆ°Æ¡ng thá»©c trá»«u tÆ°á»£ng:

```java
// Returns an instance of the Responder being tested.
protectedabstractResponder responderInstance();
```

Má»™t comment nhÆ° tháº¿ nÃ y, Ä‘Ã´i khi, cÃ³ thá»ƒ lÃ  há»¯u Ã­ch. NhÆ°ng tá»‘t hÆ¡n lÃ  sá»­ dá»¥ng tÃªn cá»§a hÃ m Ä‘á»ƒ truyá»n Ä‘áº¡t thÃ´ng tin náº¿u cÃ³ thá»ƒ. VÃ­ dá»¥, trong trÆ°á»ng há»£p nÃ y, chÃºng ta cÃ³ thá»ƒ dá»n dáº¹p comment trÃªn báº±ng cÃ¡ch Ä‘áº·t láº¡i tÃªn hÃ m thÃ nh responderBeingTested.

TrÆ°á»ng há»£p dÆ°á»›i Ä‘Ã¢y cÃ³ váº» tá»‘t hÆ¡n má»™t chÃºt:

```java
// format matched kk:mm:ss EEE, MMM dd, yyyy 
Pattern timeMatcher = Pattern.compile(
  "\\d*:\\d*:\\d* \\w*, \\w* \\d*, \\d*");
```

Trong trÆ°á»ng há»£p nÃ y, comment cho chÃºng ta biáº¿t ráº±ng biá»ƒu thá»©c Ä‘Æ°á»£c táº¡o ra khá»›p vá»›i thá»i gian vÃ  ngÃ y thÃ¡ng, vÃ  Ä‘Æ°á»£c Ä‘á»‹nh dáº¡ng báº±ng hÃ m SimpleDateFormat.format. Tuy nhiÃªn, nÃ³ cÃ³ thá»ƒ rÃµ rÃ ng hÆ¡n náº¿u code nÃ y Ä‘Æ°á»£c chuyá»ƒn sang má»™t lá»›p Ä‘áº·c biá»‡t chuyá»ƒn Ä‘á»•i Ä‘á»‹nh dáº¡ng cá»§a ngÃ y vÃ  thá»i gian. VÃ  sau Ä‘Ã³, báº¡n cÃ³ thá»ƒ Ä‘Æ°a comment trÃªn vÃ o sá»t rÃ¡c.

### Giáº£i thÃ­ch má»¥c Ä‘Ã­ch

ÄÃ´i khi comment khÃ´ng chá»‰ cung cáº¥p thÃ´ng tin vá» nhá»¯ng dÃ²ng code mÃ  cÃ²n cung cáº¥p Ã½ Ä‘á»‹nh Ä‘áº±ng sau nÃ³. Trong trÆ°á»ng há»£p sau Ä‘Ã¢y, chÃºng tÃ´i tháº¥y má»™t comment ghi láº¡i má»™t quyáº¿t Ä‘á»‹nh thÃº vá»‹: khi so sÃ¡nh hai Ä‘á»‘i tÆ°á»£ng, tÃ¡c giáº£ quyáº¿t Ä‘á»‹nh ráº±ng anh ta muá»‘n sáº¯p xáº¿p cÃ¡c Ä‘á»‘i tÆ°á»£ng cá»§a lá»›p mÃ¬nh _luÃ´n_ cao hÆ¡n cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ¡c.

```java
public int compareTo(Object o)
{
    if(o instanceof WikiPagePath)
    {
        WikiPagePath p = (WikiPagePath) o;
        String compressedName = StringUtil.join(names, "");
        String compressedArgumentName = StringUtil.join(p.names, "");
        return compressedName.compareTo(compressedArgumentName);
    }
    return 1; // we are greater because we are the right type.
}
```

DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ tá»‘t hÆ¡n. CÃ³ thá»ƒ báº¡n khÃ´ng Ä‘á»“ng tÃ¬nh vá»›i cÃ¡ch giáº£i quyáº¿t váº¥n Ä‘á» cá»§a tÃ¡c giáº£, nhÆ°ng Ã­t ra báº¡n biáº¿t Ä‘Æ°á»£c anh áº¥y Ä‘ang cá»‘ gáº¯ng lÃ m gÃ¬

```java
public void testConcurrentAddWidgets() throws Exception {
    WidgetBuilder widgetBuilder = new WidgetBuilder(new Class[]{BoldWidget.class});
    String text = "'''bold text'''";
    ParentWidget parent =
    new BoldWidget(new MockWidgetRoot(), "'''bold text'''");
    AtomicBoolean failFlag = new AtomicBoolean();
    failFlag.set(false);
    //This is our best attempt to get a race condition
    //by creating large number of threads.
    for (int i = 0; i < 25000; i++) {
        WidgetBuilderThread widgetBuilderThread =
        new WidgetBuilderThread(widgetBuilder, text, parent,
								failFlag);
        Thread thread = new Thread(widgetBuilderThread);
        thread.start();
    }
    assertEquals(false, failFlag.get());
}
```

_Race condition_ lÃ  gÃ¬: [https://en.wikipedia.org/](https://en.wikipedia.org/wiki/Race_condition)

Hoáº·c link Tiáº¿ng Viá»‡t: [https://vi.wikipedia.org](https://vi.wikipedia.org/wiki/TÆ°Æ¡ng_tranh_%28khoa_há»c_mÃ¡y_tÃ­nh%29)

### LÃ m dá»… hiá»ƒu

ÄÃ´i khi báº¡n cáº§n dÃ¹ng comment Ä‘á»ƒ diá»…n giáº£i Ã½ nghÄ©a cá»§a cÃ¡c Ä‘á»‘i sá»‘ khÃ³ hiá»ƒu hoáº·c giÃ¡ trá»‹ tráº£ vá», Ä‘á»ƒ biáº¿n chÃºng thÃ nh thá»© gÃ¬ Ä‘Ã³ cÃ³ thá»ƒ hiá»ƒu Ä‘Æ°á»£c. NhÆ°ng tá»‘t nháº¥t váº«n lÃ  tÃ¬m cÃ¡ch lÃ m cho cÃ¡c Ä‘á»‘i sá»‘ hoáº·c giÃ¡ trá»‹ tráº£ vá» Ä‘Ã³ trá»Ÿ nÃªn rÃµ rÃ ng theo cÃ¡ch cá»§a báº¡n. NhÆ°ng khi nÃ³ lÃ  má»™t pháº§n cá»§a thÆ° viá»‡n, hoáº·c thuá»™c vá» má»™t pháº§n code mÃ  báº¡n khÃ´ng cÃ³ quyá»n tÃ¹y chá»‰nh, thÃ¬ má»™t comment giáº£i thÃ­ch dá»… hiá»ƒu cÃ³ thá»ƒ cÃ³ Ã­ch trong trÆ°á»ng há»£p nÃ y.

```java
public void testCompareTo() throws Exception
{
    WikiPagePath a = PathParser.parse("PageA");
    WikiPagePath ab = PathParser.parse("PageA.PageB");
    WikiPagePath b = PathParser.parse("PageB");
    WikiPagePath aa = PathParser.parse("PageA.PageA");
    WikiPagePath bb = PathParser.parse("PageB.PageB");
    WikiPagePath ba = PathParser.parse("PageB.PageA");

    assertTrue(a.compareTo(a) == 0); // a == a
    assertTrue(a.compareTo(b) != 0); // a != b
    assertTrue(ab.compareTo(ab) == 0); // ab == ab
    assertTrue(a.compareTo(b) == -1); // a < b
    assertTrue(aa.compareTo(ab) == -1); // aa < ab
    assertTrue(ba.compareTo(bb) == -1); // ba < bb
    assertTrue(b.compareTo(a) == 1); // b > a
    assertTrue(ab.compareTo(aa) == 1); // ab > aa
    assertTrue(bb.compareTo(ba) == 1); // bb > ba
}
```

DÄ© nhiÃªn, kháº£ nÄƒng cÃ¡c comment dáº¡ng nÃ y cung cáº¥p thÃ´ng tin khÃ´ng chÃ­nh xÃ¡c lÃ  khÃ¡ cao. Xem láº¡i cÃ¡c vÃ­ dá»¥ trÆ°á»›c Ä‘á»ƒ tháº¥y ráº±ng viá»‡c xÃ¡c nháº­n thÃ´ng tin tá»« comment khÃ³ tháº¿ nÃ o. Äiá»u nÃ y giáº£i thÃ­ch lÃ½ do táº¡i sao lÃ m cho comment dá»… hiá»ƒu lÃ  cáº§n thiáº¿t, máº·c dÃ¹ Ä‘iá»u Ä‘Ã³ Ä‘á»“ng nghÄ©a vá»›i sá»± máº¡o hiá»ƒm. Váº­y nÃªn trÆ°á»›c khi báº¡n viáº¿t nhá»¯ng comment nhÆ° tháº¿ nÃ y, hÃ£y cháº¯c cháº¯n ráº±ng khÃ´ng cÃ²n cÃ¡ch nÃ o tá»‘i Æ°u hÆ¡n, vÃ¬ sau Ä‘Ã³ báº¡n cáº§n quan tÃ¢m Ä‘áº¿n Ä‘á»™ chÃ­nh xÃ¡c cá»§a chÃºng má»—i khi báº¡n chá»‰nh sá»­a láº¡i code.

### CÃ¡c cáº£nh bÃ¡o vá» háº­u quáº£

ÄÃ´i khi nÃ³ ráº¥t há»¯u Ã­ch Ä‘á»ƒ cáº£nh bÃ¡o cÃ¡c láº­p trÃ¬nh viÃªn khÃ¡c vá» háº­u quáº£ xáº£y ra. VÃ­ dá»¥, Ä‘Ã¢y lÃ  má»™t comment giáº£i thÃ­ch táº¡i sao test case nÃ y láº¡i bá»‹ táº¯t:

```java
// Don't run unless you 
// have some time to kill â€“ Äá»«ng cháº¡y hÃ m nÃ y, trá»« khi mÃ y quÃ¡ ráº£nh 
public void _testWithReallyBigFile() {
    writeLinesToFile(10000000);
    response.setBody(testFile); 
    response.readyToSend(this); 
    String responseString = output.toString();
    assertSubString("Content-Length: 1000000000", responseString); 
    assertTrue(bytesSent > 1000000000); 
}
```

Táº¥t nhiÃªn lÃ  ngÃ y nay, chÃºng tÃ´i táº¯t cÃ¡c test case báº±ng cÃ¡ch sá»­ dá»¥ng thuá»™c tÃ­nh `@Ignore` vá»›i má»™t chuá»—i giáº£i thÃ­ch thÃ­ch há»£p: `@Ignore ("It takes too long to run")`. NhÆ°ng trÆ°á»›c khi JUnit 4 xuáº¥t hiá»‡n, viá»‡c Ä‘áº·t má»™t dáº¥u gáº¡ch dÆ°á»›i vÃ o trÆ°á»›c tÃªn hÃ m lÃ  má»™t quy táº¯c ráº¥t phá»• biáº¿n. CÃ¡c comment Ä‘á»“ng thá»i Ä‘Æ°á»£c xem nhÆ° lÃ  cÃ¡ch Ä‘Ã¡nh dáº¥u Ä‘á»ƒ láº­p trÃ¬nh viÃªn chÃº Ã½ Ä‘áº¿n cáº£nh bÃ¡o cá»§a hÃ m hÆ¡n.

ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ Ä‘au khá»• khÃ¡c:

```java
public static SimpleDateFormat makeStandardHttpDateFormat()
{
    //SimpleDateFormat is not thread safe,
    //so we need to create each instance independently.
    SimpleDateFormat df = new SimpleDateFormat("EEE, dd MMM yyyy HH:mm:ss z");
    df.setTimeZone(TimeZone.getTimeZone("GMT"));
    return df;
}
```

CÃ³ thá»ƒ cÃ²n nhiá»u cÃ¡ch tá»‘t hÆ¡n. TÃ´i Ä‘á»“ng Ã½. NhÆ°ng comment trong trÆ°á»ng há»£p nÃ y lÃ  hoÃ n toÃ n há»£p lÃ½, nÃ³ sáº½ ngÄƒn Ä‘Æ°á»£c má»™t sá»‘ láº­p trÃ¬nh viÃªn ham há»‘ sá»­ dá»¥ng má»™t phÆ°Æ¡ng thá»©c khá»Ÿi táº¡o tÄ©nh.

### TODO comments

ÄÃ´i khi viá»‡c Ä‘á»ƒ láº¡i cÃ¡c dÃ²ng comment dáº¡ng //TODO lÃ  Ä‘iá»u cáº§n thiáº¿t. Trong trÆ°á»ng há»£p dÆ°á»›i Ä‘Ã¢y, comment dáº¡ng TODO giáº£i thÃ­ch táº¡i sao hÃ m nÃ y láº¡i lÃ  hÃ m suy biáº¿n, vÃ  tÆ°Æ¡ng lai cá»§a hÃ m sáº½ nhÆ° tháº¿ nÃ o:

```java
// TODO-MdM these are not needed â€“ HÃ m nÃ y khÃ´ng cáº§n thiáº¿t
// We expect this to go away when we do the checkout model
// NÃ³ sáº½ bá»‹ xÃ³a khi chÃºng tÃ´i thá»±c hiá»‡n mÃ´ hÃ¬nh thanh toÃ¡n
protected VersionInfo makeVersion() throws Exception
{
    return null;
}
```

Nhá»¯ng comment dáº¡ng TODO lÃ  nhá»¯ng cÃ´ng viá»‡c mÃ  láº­p trÃ¬nh viÃªn cho ráº±ng nÃªn Ä‘Æ°á»£c thá»±c hiá»‡n, nhÆ°ng vÃ¬ lÃ½ do nÃ o Ä‘Ã³ mÃ  há» khÃ´ng thá»ƒ thá»±c hiá»‡n nÃ³ ngay lÃºc nÃ y. NÃ³ cÃ³ thá»ƒ lÃ  má»™t lá»i nháº¯c Ä‘á»ƒ xÃ³a má»™t hÃ m khÃ´ng dÃ¹ng ná»¯a, hoáº·c yÃªu cáº§u ngÆ°á»i khÃ¡c xem xÃ©t má»™t sá»‘ váº¥n Ä‘á»: Ä‘áº·t láº¡i má»™t cÃ¡i tÃªn khÃ¡c tá»‘t hÆ¡n, lá»i nháº¯c thay Ä‘á»•i code cá»§a hÃ m khi káº¿ hoáº¡ch cá»§a dá»± Ã¡n thay Ä‘á»•i,.. NhÆ°ng dÃ¹ TODO cÃ³ lÃ  gÃ¬ Ä‘i ná»¯a, nÃ³ cháº¯c cháº¯n khÃ´ng pháº£i lÃ  lÃ½ do Ä‘á»ƒ báº¡n quÄƒng Ä‘á»‘ng code áº©u, code bá»«a vÃ o dá»± Ã¡n.

NgÃ y nay, háº§u háº¿t cÃ¡c IDE Ä‘á»u cung cáº¥p cÃ¡c tÃ­nh nÄƒng Ä‘áº·c biá»‡t Ä‘á»ƒ Ä‘á»‹nh vá»‹ cÃ¡c comment TODO, do Ä‘Ã³ báº¡n khÃ´ng cáº§n lo viá»‡c bá» quÃªn/láº¡c máº¥t nÃ³. Tuy váº­y, báº¡n sáº½ khÃ´ng muá»‘n code cá»§a báº¡n bá»‹ láº¥p Ä‘áº§y bá»Ÿi TODO. Váº­y nÃªn hÃ£y thÆ°á»ng xuyÃªn Ä‘á»ƒ máº¯t tá»›i chÃºng vÃ  dá»n dáº¹p chÃºng ngay khi cÃ³ thá»ƒ.

### Khuáº¿ch Ä‘áº¡i

Comment cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ khuáº¿ch Ä‘áº¡i táº§m quan trá»ng cá»§a má»™t cÃ¡i gÃ¬ Ä‘Ã³ cÃ³ váº» khÃ´ng quan trá»ng:

```java
String listItemContent = match.group(3).trim();
// the trim is real important. It removes the starting
// spaces that could cause the item to be recognized
// as another list.
new ListItemWidget(this, listItemContent, this.level + 1);
return buildList(text.substring(match.end()));
```

### Javadocs in Public APIs

KhÃ´ng cÃ³ gÃ¬ há»¯u Ã­ch vÃ  tuyá»‡t vá»i báº±ng má»™t public API Ä‘Æ°á»£c mÃ´ táº£ tá»‘t. CÃ¡c javadoc cá»§a thÆ° viá»‡n chuáº©n cá»§a Java lÃ  má»™t trÆ°á»ng há»£p Ä‘iá»ƒn hÃ¬nh. Sáº½ ráº¥t khÃ³ Ä‘á»ƒ viáº¿t cÃ¡c chÆ°Æ¡ng trÃ¬nh Java mÃ  thiáº¿u chÃºng.

Náº¿u Ä‘ang viáº¿t má»™t public API, cháº¯c cháº¯n báº¡n nÃªn viáº¿t javadoc tá»‘t cho nÃ³. NhÆ°ng hÃ£y ghi nhá»› nhá»¯ng lá»i khuyÃªn cÃ²n láº¡i cá»§a chÆ°Æ¡ng nÃ y, cÃ¡c javadoc cÃ³ thá»ƒ lÃ  má»™t cÃº lá»«a, hoáº·c mang láº¡i phiá»n toÃ¡i nhÆ° báº¥t ká»³ comment nÃ o khÃ¡c .

## Bad Comments

Äa sá»‘ cÃ¡c comment rÆ¡i vÃ o thá»ƒ loáº¡i nÃ y. ChÃºng thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° cÃ¡i cá»› cho viá»‡c viáº¿t code rá»Ÿm hoáº·c biá»‡n minh cho cÃ¡c cÃ¡ch giáº£i quyáº¿t Ä‘áº§y thiáº¿u sÃ³t, cÃ¡c giÃ¡ trá»‹ khÃ´ng Ä‘áº§y Ä‘á»§ so vá»›i cÃ¡ch láº­p trÃ¬nh viÃªn nghÄ© vá» nÃ³.

### Äá»™c thoáº¡i

QuÄƒng vÃ o má»™t comment chá»‰ vÃ¬ báº¡n tháº¥y _thÃ­ch_, hoáº·c chá»‰ vÃ¬ quÃ¡ trÃ¬nh xá»­ lÃ½ cáº§n Ä‘áº¿n nÃ³, Ä‘iá»u Ä‘Ã³ Ä‘Æ°á»£c gá»i lÃ  _hack_ (giáº£i quyáº¿t váº¥n Ä‘á» khÃ´ng theo cÃ¡ch thÆ°á»ng mÃ  dÃ¹ng thá»§ thuáº­t, Ä‘Æ°á»ng táº¯t,...). Náº¿u báº¡n quyáº¿t Ä‘á»‹nh viáº¿t comment, hÃ£y dÃ nh thá»i gian cho nÃ³ Ä‘á»ƒ Ä‘áº£m báº£o Ä‘Ã³ lÃ  comment tá»‘t nháº¥t mÃ  báº¡n cÃ³ thá»ƒ viáº¿t.

DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ tÃ´i tÃ¬m tháº¥y trong FitNesse, comment nÃ y cÃ³ thá»ƒ há»¯u Ã­ch. NhÆ°ng tÃ¡c giáº£ Ä‘Ã£ vá»™i vÃ ng hoáº·c Ä‘Ã£ khÃ´ng quan tÃ¢m nhiá»u Ä‘áº¿n nÃ³. CÃ¡ch anh ta Ä‘á»™c thoáº¡i lÃ m cho ngÆ°á»i Ä‘áº¿n sau cáº£m tháº¥y hoang mang:

```java
public void loadProperties()
{
    try
    {
        String propertiesPath = propertiesLocation + "/" + PROPERTIES_FILE;
        FileInputStream propertiesStream = new FileInputStream(propertiesPath);
        loadedProperties.load(propertiesStream);
    }
    catch(IOException e)
    {
        // No properties files means all defaults are loaded
    }
}
```

Comment trong khá»‘i cacth trÃªn nghÄ©a lÃ  gÃ¬? Háº³n lÃ  nÃ³ cÃ³ Ã½ nghÄ©a gÃ¬ Ä‘Ã³ Ä‘á»‘i vá»›i tÃ¡c giáº£, nhÆ°ng láº¡i khÃ´ng Ä‘Æ°á»£c diá»…n giáº£i Ä‘áº§y Ä‘á»§. RÃµ rÃ ng, náº¿u IOExeptionxÃ£y ra, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  khÃ´ng cÃ³ thuá»™c tÃ­nh file, vÃ  trong trÆ°á»ng há»£p nÃ y cÃ¡c thuá»™c tÃ­nh máº·c Ä‘á»‹nh sáº½ Ä‘Æ°á»£c táº£i. NhÆ°ng, cÃ¡i gÃ¬ sáº½ táº£i thuá»™c tÃ­nh máº·c Ä‘á»‹nh? Nhá»¯ng thuá»™c tÃ­nh máº·c Ä‘á»‹nh Ä‘Ã³ Ä‘Ã£ Ä‘Æ°á»£c táº£i trÆ°á»›c khi gá»i loadProperties()? Hay chÃºng Ä‘Æ°á»£c táº£i khi loadedProperties.load(propertiesStream) phÃ¡t sinh Exception? Hay chÃºng Ä‘Æ°á»£c táº£i sau khi gá»i loadProperties() ? CÃ³ pháº£i tÃ¡c giáº£ chá»‰ Ä‘ang cá»‘ lÃ m hÃ i lÃ²ng chÃ­nh báº£n thÃ¢n anh ta vá» viá»‡c bá» trá»‘ng khá»‘i catch? Hoáº·c, kinh khá»§ng hÆ¡n â€“ tÃ¡c giáº£ Ä‘Ã£ dÃ¹ng comment nhÆ° má»™t dáº¥u hiá»‡u, Ä‘á»ƒ sau nÃ y quay láº¡i vÃ  viáº¿t cÃ¡c Ä‘oáº¡n code táº£i cÃ¡c thuá»™c tÃ­nh máº·c Ä‘á»‹nh vÃ o khá»‘i catch?

CÃ¡ch duy nháº¥t lÃ  kiá»ƒm tra code cá»§a há»‡ thá»‘ng Ä‘á»ƒ tÃ¬m hiá»ƒu nhá»¯ng gÃ¬ xáº£y ra. Báº¥t ká»³ comment nÃ o khiáº¿n báº¡n pháº£i lá»¥c tung code cá»§a há»‡ thá»‘ng lÃªn Ä‘á»ƒ tÃ¬m hiá»ƒu thÃ¬ comment Ä‘Ã³ khÃ´ng truyá»n táº£i tá»‘t thÃ´ng tin cho báº¡n, vÃ  nÃ³ khÃ´ng xá»©ng Ä‘Ã¡ng vá»›i sá»‘ bit nÃ³ chiáº¿m trong mÃ£ nguá»“n.

### CÃ¡c comment thá»«a tháº£i

Listing 4-1 cho tháº¥y má»™t hÃ m Ä‘Æ¡n giáº£n vá»›i cÃ¡c comment á»Ÿ Ä‘áº§u hoÃ n toÃ n thá»«a tháº£i. Comment nÃ y, cÃ³ láº½, cÃ²n lÃ m ngÆ°á»i Ä‘á»c máº¥t thá»i gian hÆ¡n so vá»›i viá»‡c Ä‘á»c code cá»§a hÃ m.

| Listing 4-1 **waitForClose** |
| --- |
```java
// Utility method that returns when this.closed is true. Throws an exception
// if the timeout is reached.
// PhÆ°Æ¡ng thá»©c return khi this.closed lÃ  true, phÃ¡t sinh ngoáº¡i lá»‡ náº¿u háº¿t thá»i gian chá»
public synchronized void waitForClose(final long timeoutMillis)
throws Exception
{
    if(!closed)
    {
        wait(timeoutMillis);
        if(!closed)
            throw new Exception("MockResponseSender could not be closed");
    }
}
```

Comment nÃ y nháº±m má»¥c Ä‘Ã­ch gÃ¬? NÃ³ cháº¯n cháº¯n khÃ´ng cung cáº¥p nhiá»u thÃ´ng tin hÆ¡n code. NÃ³ khÃ´ng diá»…n giáº£i cho code, khÃ´ng cung cáº¥p má»¥c Ä‘Ã­ch hoáº·c lÃ½ do. NÃ³ khÃ´ng dá»… hiá»ƒu hÆ¡n code. Sá»± tháº­t lÃ , nÃ³ Ã­t chÃ­nh xÃ¡c hÆ¡n code nhÆ°ng láº¡i lÃ´i cuá»‘n ngÆ°á»i Ä‘á»c cháº¥p nháº­n sá»± thiáº¿u chÃ­nh xÃ¡c Ä‘Ã³ thay cho hiá»ƒu biáº¿t tháº­t sá»±.

BÃ¢y giá» hÃ£y xem xÃ©t vÃ´ sá»‘ comment vÃ´ Ã­ch vÃ  dÆ° thá»«a cá»§a javadocs trong Listing 4-2 Ä‘Æ°á»£c láº¥y tá»« Tomcat. Nhá»¯ng comment nÃ y chá»‰ Ä‘á»ƒ lÃ m lá»™n xá»™n vÃ  lÃ m code thÃªm khÃ³ hiá»ƒu. ChÃºng tá»“n táº¡i nhÆ°ng khÃ´ng vÃ¬ má»¥c Ä‘Ã­ch cung cáº¥p thÃ´ng tin mÃ  chá»‰ khiáº¿n má»i thá»© tá»‡ hÆ¡n. TÃ´i chá»‰ chá»‰ ra cho báº¡n Ä‘Æ°á»£c má»™t vÃ i dÃ²ng Ä‘áº§u tiÃªn, cÃ²n nhiá»u hÆ¡n ná»¯a náº¿u báº¡n xem qua háº¿t module nÃ y.

| Listing 4-2 **ContainerBase.java (Tomcat)** |
| --- |
```java
public abstract class ContainerBase
implements Container, Lifecycle, Pipeline,
MBeanRegistration, Serializable {
    /**
     * The processor delay for this component.
     */
    protected int backgroundProcessorDelay = -1;
    /**
     * The lifecycle event support for this component.
     */
    protected LifecycleSupport lifecycle = new LifecycleSupport(this);
    /**
     * The container event listeners for this Container.
     */
    protected ArrayList listeners = new ArrayList();
    /**
     * The Loader implementation with which this Container is
     * associated.
     */
    protected Loader loader = null;
    /**
     * The Logger implementation with which this Container is
     * associated.
     */
    protected Log logger = null;
    /**
     * Associated logger name.
     */
    protected String logName = null;
    /**
     * The Manager implementation with which this Container is
     * associated.
     */
    protected Manager manager = null;
    /**
     * The cluster with which this Container is associated.
     */
    protected Cluster cluster = null;
    /**
     * The human-readable name of this Container.
     */
    protected String name = null;
    /**
     * The parent Container to which this Container is a child.
     */
    protected Container parent = null;
    /**
     * The parent class loader to be configured when we install a
     * Loader.
     */
    protected ClassLoader parentClassLoader = null;
    /**
     * The Pipeline object with which this Container is
     * associated.
     */
    protected Pipeline pipeline = new StandardPipeline(this);
    /**
     * The Realm with which this Container is associated.
     */
    protected Realm realm = null;
    /**
     * The resources DirContext object with which this Container
     * is associated.
     */
    protected DirContext resources = null;
```

### CÃ¡c comment sai sá»± tháº­t

ÄÃ´i khi, vá»›i má»¥c Ä‘Ã­ch hoÃ n toÃ n trong sÃ¡ng, má»™t láº­p trÃ¬nh viÃªn diá»…n Ä‘áº¡t Ã½ Ä‘á»‹nh cá»§a anh ta trong comment, nhÆ°ng nÃ³ láº¡i khÃ´ng Ä‘á»§ chÃ­nh xÃ¡c. HÃ£y dÃ nh má»™t Ã­t thá»i gian Ä‘á»ƒ xem láº¡i comment dÆ° thá»«a vÃ  sai lá»‡ch trong Listing 4-1.

Báº¡n cÃ³ phÃ¡t hiá»‡n ra comment á»Ÿ Listing 4-1 sai lá»‡ch nhÆ° tháº¿ nÃ o chÆ°a? PhÆ°Æ¡ng thá»©c khÃ´ng `return` khi `this.closed` lÃ  `true`, nÃ³ `return` náº¿u `this.closed` lÃ  `true`. Máº·t khÃ¡c, nÃ³ giáº£ vá» chá» má»™t khoáº£n thá»i gian vÃ  sinh ra má»™t Exception náº¿u `this.closed` váº«n chÆ°a lÃ  `true`.

Má»™t chÃºt thÃ´ng tin sai lá»‡ch, áº©n náº¥p trong má»™t comment khÃ³ Ä‘á»c hÆ¡n cáº£ code mÃ  nÃ³ diá»…n giáº£i. Äiá»u nÃ y cÃ³ thá»ƒ khiáº¿n má»™t láº­p trÃ¬nh viÃªn khÃ¡c gá»i hÃ m nÃ y vÃ  mong muá»‘n nÃ³ return ngay khi this.closed trá»Ÿ thÃ nh true. Sau Ä‘Ã³ anh ta pháº£i debug chÆ°Æ¡ng trÃ¬nh Ä‘á»ƒ tÃ¬m cÃ¢u tráº£ lá»i cho viá»‡c nÃ³ thá»±c thi quÃ¡ cháº­m.

### CÃ¡c comment báº¯t buá»™c

Tháº­t Ä‘iÃªn rá»“ khi cho ráº±ng táº¥t cáº£ cÃ¡c hÃ m Ä‘á»u pháº£i cÃ³ javadoc, hoáº·c má»i biáº¿n Ä‘á»u pháº£i cÃ³ comment. Nhá»¯ng comment nhÆ° váº­y chá»‰ lÃ m rá»‘i code, Ä‘Æ°a ra nhá»¯ng lá»i bá»‹a Ä‘áº·t, vÃ  á»§ng há»™ viá»‡c gÃ¢y nháº§m láº«n vÃ  vÃ´ tá»• chá»©c.

VÃ­ dá»¥, javadoc Ä‘Æ°á»£c yÃªu cáº§u cho má»i hÃ m dáº«n Ä‘áº¿n sá»± kinh khá»§ng khiáº¿p nhÆ° Listing 4-3. TÃ¬nh tráº¡ng lá»™n xá»™n nÃ y khÃ´ng giÃºp Ã­ch Ä‘Æ°á»£c gÃ¬ mÃ  ngÆ°á»£c láº¡i,nÃ³ chá»‰ lÃ m xÃ¡o trá»™n code vÃ  ngáº§m táº¡o ra nhá»¯ng cÃº lá»«a khÃ¡c,...

| Listing 4-3 |
| --- |
```java
/**
 *
 * @param title The title of the CD
 * @param author The author of the CD
 * @param tracks The number of tracks on the CD
 * @param durationInMinutes The duration of the CD in minutes
 */
public void addCD(String title, String author,
 int tracks, int durationInMinutes) {
    CD cd = new CD();
    cd.title = title;
    cd.author = author;
    cd.tracks = tracks;
    cd.duration = duration;
    cdList.add(cd);
}
```

### CÃ¡c comment nháº­t kÃ½

ÄÃ´i khi má»i ngÆ°á»i thÃªm má»™t comment vÃ o Ä‘áº§u module má»—i khi há» chá»‰nh sá»­a nÃ³. Nhá»¯ng comment nÃ y tÃ­ch lÅ©y nhÆ° má»™t loáº¡i nháº­t kÃ½ lÆ°u láº¡i má»i thay Ä‘á»•i Ä‘Ã£ tá»«ng Ä‘Æ°á»£c thá»±c hiá»‡n. TÃ´i Ä‘Ã£ tháº¥y má»™t sá»‘ module vá»›i hÃ ng trÄƒm dÃ²ng nhÆ° tháº¿ nÃ y:

```java
/*
 * Changes (from 11-Oct-2001)
 * --------------------------
 * 11-Oct-2001 : Re-organised the class and moved it to new package
 * com.jrefinery.date (DG);
 * 05-Nov-2001 : Added a getDescription() method, and eliminated NotableDate
 * class (DG);
 * 12-Nov-2001 : IBD requires setDescription() method, now that NotableDate
 * class is gone (DG); Changed getPreviousDayOfWeek(),
 * getFollowingDayOfWeek() and getNearestDayOfWeek() to correct
 * bugs (DG);
 * 05-Dec-2001 : Fixed bug in SpreadsheetDate class (DG);
 * 29-May-2002 : Moved the month constants into a separate interface
 * (MonthConstants) (DG);
 * 27-Aug-2002 : Fixed bug in addMonths() method, thanks to N???levka Petr (DG);
 * 03-Oct-2002 : Fixed errors reported by Checkstyle (DG);
 * 13-Mar-2003 : Implemented Serializable (DG);
 * 29-May-2003 : Fixed bug in addMonths method (DG);
 * 04-Sep-2003 : Implemented Comparable. Updated the isInRange javadocs (DG);
 * 05-Jan-2005 : Fixed bug in addYears() method (1096282) (DG);
 */
```

NgÃ y xá»­a ngÃ y xÆ°a, chÃºng tÃ´i cÃ³ lÃ½ do chÃ­nh Ä‘Ã¡ng Ä‘á»ƒ táº¡o vÃ  cáº­p nháº­t cÃ¡c nháº­t kÃ½ nÃ y khi báº¯t Ä‘áº§u má»™t module. á» thá»i Ä‘iá»ƒm Ä‘Ã³, cÃ¡c há»‡ thá»‘ng quáº£n lÃ½ mÃ£ nguá»“n (source control) chÆ°a xuáº¥t hiá»‡n vÃ  chÃºng tÃ´i pháº£i thá»±c hiá»‡n Ä‘iá»u nÃ y. NhÆ°ng ngÃ y nay, nhá»¯ng nháº­t kÃ½ nÃ y chá»‰ lÃ m module lá»™n xá»™n hÆ¡n. ChÃºng nÃªn Ä‘Æ°á»£c loáº¡i bá» hoÃ n toÃ n.

### CÃ¡c comment gÃ¢y nhiá»…u

ÄÃ´i khi báº¡n gáº·p cÃ¡c comment khÃ´ng cung cáº¥p thÃ´ng tin gÃ¬ ngoÃ i sá»± phiá»n phá»©c, chÃºng láº·p láº¡i má»™t váº¥n Ä‘á» hiá»ƒn nhiÃªn vÃ  khÃ´ng cung cáº¥p thÃªm thÃ´ng tin má»›i

```java
/**
 * Default constructor.
 */
protected AnnualDateRule() {
}
```

RÃ¬a-lÃ½? CÃ²n cÃ¡i nÃ y:

```java
/** The day of the month. */
private int dayOfMonth;
```

VÃ  sau Ä‘Ã³ lÃ  sá»± thá»«a thÃ£i nÃ y:

```java
/**
 * Returns the day of the month.
 *
 * @return the day of the month.
 */
public int getDayOfMonth() {
    return dayOfMonth;
}
```

Nhá»¯ng comment nÃ y phiá»n Ä‘áº¿n má»©c chÃºng tÃ´i pháº£i há»c cÃ¡ch bá» qua chÃºng. Khi chÃºng tÃ´i Ä‘á»c code, máº¯t chÃºng tÃ´i chá»‰ lÆ°á»›t qua chÃºng. Cuá»‘i cÃ¹ng, cÃ¡c comment báº¯t Ä‘áº§u sai lá»‡ch khi code xung quanh chÃºng thay Ä‘á»•i, cÃ²n chÃºng thÃ¬ khÃ´ng â€“ ai láº¡i Ä‘á»ƒ Ã½ Ä‘áº¿n chÃºng chá»©.

Comment Ä‘áº§u tiÃªn trong Listing 4-4 cÃ³ váº» há»£p lÃ½, nÃ³ giáº£i thÃ­ch táº¡i sao khá»‘i `catch` Ä‘Æ°á»£c bá» qua. NhÆ°ng comment thá»© hai chá»‰ Ä‘Æ¡n thuáº§n lÃ  gÃ¢y nhiá»…u cho ngÆ°á»i Ä‘á»c. RÃµ rÃ ng láº­p trÃ¬nh viÃªn nÃ y Ä‘Ã£ ráº¥t má»‡t má»i vá»›i viá»‡c viáº¿t cÃ¡c khá»‘i `try/catch` vÃ  anh ta Ä‘ang trÃºt giáº­n.

| Listing 4-4 **startSending** |
| --- |
```java
private void startSending()
{
    try
    {
        doSending();
    }
    catch(SocketException e)
    {
        // normal. someone stopped the request.
    }
    catch(Exception e)
    {
        try
        {
            response.add(ErrorResponder.makeExceptionString(e));
            response.closeAll();
        }
        catch(Exception e1)
        {
            //Give me a break! â€“ ÄÆ°a tao ra khá»i Ä‘Ã¢y!
        }
    }
}
```

Thay vÃ¬ trÃºt giáº­n vÃ o má»™t comment vÃ´ giÃ¡ trá»‹ vÃ  gÃ¢y bá»‘i rá»‘i cho ngÆ°á»i Ä‘á»c, láº­p trÃ¬nh viÃªn nÃªn nháº­n ra ráº±ng váº¥n Ä‘á» cá»§a anh ta cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t báº±ng cÃ¡ch tÃ¡i cáº¥u trÃºc láº¡i pháº§n code Ä‘Ã³. Anh ta nÃªn sá»­ dá»¥ng nÄƒng lÆ°á»£ng cá»§a mÃ¬nh cho viá»‡c chuyá»ƒn khá»‘i try/catch Ä‘Ã³ thÃ nh má»™t hÃ m riÃªng biá»‡t, nhÆ° trong Listing 4-5

| Listing 4-5 **startSending (refactored)** |
| --- |
```java
private void startSending()
{
    try
    {
        doSending();
    }
    catch(SocketException e)
    {
        // normal. someone stopped the request.
    }
    catch(Exception e)
    {
        addExceptionAndCloseResponse(e);
    }
}
private void addExceptionAndCloseResponse(Exception e)
{
    try
    {
        response.add(ErrorResponder.makeExceptionString(e));
        response.closeAll();
    }
    catch(Exception e1)
    {
    }
}
```

TrÃ¡nh viá»‡c viáº¿t comment gÃ¢y nhiá»…u báº±ng quyáº¿t tÃ¢m lÃ m sáº¡ch code. Báº¡n sáº½ tháº¥y Ä‘iá»u Ä‘Ã³ lÃ m cho báº¡n trá»Ÿ thÃ nh má»™t láº­p trÃ¬nh viÃªn Ä‘áº³ng cáº¥p hÆ¡n, vÃ  háº¡nh phÃºc hÆ¡n.

### (Láº¡i lÃ ) cÃ¡c comment gÃ¢y nhiá»…u â€“ nhÆ°ng Ä‘Ã¡ng sá»£ hÆ¡n

CÃ¡c javadoc cÅ©ng cÃ³ thá»ƒ trá»Ÿ nÃªn phiá»n phá»©c. Má»¥c Ä‘Ã­ch cá»§a cÃ¡c javadoc sau lÃ  gÃ¬ (tá»« má»™t thÆ° viá»‡n mÃ£ nguá»“n má»Ÿ ná»•i tiáº¿ng)? Tráº£ lá»i: KhÃ´ng gÃ¬ cáº£. ChÃºng chá»‰ lÃ  nhá»¯ng comment dÆ° thá»«a, bá»‹ sao chÃ©p láº¡i nhÆ° má»™t khao khÃ¡t cung cáº¥p tÃ i liá»‡u cho láº­p trÃ¬nh viÃªn.

```java
/** The name. */
private String name;
/** The version. */
private String version;
/** The licenceName. */
private String licenceName;
/** The version. */
private String info;
```

Xem nhá»¯ng comment trÃªn má»™t láº§n ná»¯a, báº¡n cÃ³ tháº¥y lá»—i cáº¯t-dÃ¡n khÃ´ng? Náº¿u tÃ¡c giáº£ Ä‘Ã£ khÃ´ng chÃº Ã½ Ä‘áº¿n comment khi viáº¿t (hoáº·c dÃ¡n) chÃºng, sao chÃºng ta cÃ³ thá»ƒ trÃ´ng mong chÃºng giÃºp Ã­ch Ä‘Æ°á»£c chÃºng ta?

### Äá»«ng dÃ¹ng comment khi báº¡n cÃ³ thá»ƒ dÃ¹ng hÃ m hoáº·c biáº¿n

HÃ£y xem xÃ©t Ä‘oáº¡n code sau:

```java
// does the module from the global list <mod> depend on the
// subsystem we are part of?
if (smodule.getDependSubsystems().contains(subSysMod.getSubSystem()))
```

ChÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t láº¡i mÃ  khÃ´ng cáº§n comment:

```java
ArrayList moduleDependees = smodule.getDependSubsystems();
String ourSubSystem = subSysMod.getSubSystem();
if (moduleDependees.contains(ourSubSystem))
```

CÃ³ thá»ƒ tÃ¡c giáº£ Ä‘Ã£ viáº¿t comment trÆ°á»›c (tÃ´i Ä‘oÃ¡n tháº¿), vÃ  sau Ä‘Ã³ viáº¿t code Ä‘á»ƒ hoÃ n thÃ nh ná»™i dung cá»§a comment. Tuy nhiÃªn, tÃ¡c giáº£ nÃªn tÃ¡i cáº¥u trÃºc code, nhÆ° tÃ´i Ä‘Ã£ lÃ m, Ä‘á»ƒ comment Ä‘Æ°á»£c xÃ³a mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n thÃ´ng Ä‘iá»‡p cá»§a Ä‘oáº¡n code Ä‘Ã³.

### ÄÃ¡nh dáº¥u lÃ£nh thá»•

Thá»‰nh thoáº£ng vÃ i láº­p trÃ¬nh viÃªn thÃ­ch Ä‘Ã¡nh dáº¥u má»™t vá»‹ trÃ­ trong tá»‡p mÃ£ nguá»“n. VÃ­ dá»¥, gáº§n Ä‘Ã¢y tÃ´i Ä‘Ã£ tháº¥y thá»© nÃ y trong má»™t chÆ°Æ¡ng trÃ¬nh tÃ´i Ä‘ang xem xÃ©t:

```java
// Actions //////////////////////////////////
```

Ráº¥t hiáº¿m khi cÃ¡c hÃ m cÃ³ cÃ¹ng chá»©c nÄƒng Ä‘Æ°á»£c táº­p há»£p bÃªn dÆ°á»›i má»™t cÃ¢u miÃªu táº£ nhÆ° tháº¿ nÃ y. NhÆ°ng nÃ³i chung, chÃºng Ä‘ang bá»«a bá»™n nÃªn cáº§n pháº£i loáº¡i bá», Ä‘áº·c biá»‡t lÃ  cáº£ tÃ¡ dáº¥u slash á»Ÿ cuá»‘i cÃ¢u.

Theo cÃ¡ch nghÄ© nÃ y, má»™t comment Ä‘Ã¡nh dáº¥u sáº½ gÃ¢y chÃº Ã½ máº¡nh náº¿u báº¡n khÃ´ng thÆ°á»ng xuyÃªn nhÃ¬n tháº¥y chÃºng. VÃ¬ váº­y, hÃ£y háº¡n cháº¿ dÃ¹ng, vÃ  chá»‰ dÃ¹ng náº¿u chÃºng mang láº¡i lá»£i Ã­ch Ä‘Ã¡ng ká»ƒ. Náº¿u bá»‹ láº¡m dá»¥ng, chÃºng sáº½ bá»‹ ngÆ°á»i Ä‘á»c cho vÃ o vÃ¹ng "phiá»n phá»©c" vÃ  nhanh chÃ³ng bá»‹ bá» qua.

### CÃ¡c comment káº¿t thÃºc

ÄÃ´i khi cÃ¡c láº­p trÃ¬nh viÃªn sáº½ Ä‘Æ°a ra cÃ¡c comment cá»¥ thá»ƒ vá» viá»‡c Ä‘Ã³ng dáº¥u ngoáº·c nhá»n, nhÆ° trong Listing 4-6. Máº·c dÃ¹ Ä‘iá»u nÃ y cÃ³ thá»ƒ cÃ³ Ã½ nghÄ©a vá»›i cÃ¡c hÃ m dÃ i vÃ  cÃ³ nhiá»u cáº¥u trÃºc lá»“ng nhau, nhÆ°ng chÃºng láº¡i thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng trong cÃ¡c hÃ m nhá», hoáº·c cÃ¡c hÃ m mÃ  láº­p trÃ¬nh viÃªn tháº¥y thÃ­ch. VÃ¬ váº­y láº§n tá»›i náº¿u muá»‘n Ä‘Ã¡nh dáº¥u káº¿t thÃºc má»™t khá»‘i lá»‡nh phá»©c táº¡p, hÃ£y thá»­ chia nhá» hoáº·c rÃºt ngáº¯n hÃ m cá»§a báº¡n.

| Listing 4-6 **wc.java** |
| --- |
```java
public class wc {
    public static void main(String[] args) {
        BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
        String line;
        int lineCount = 0;
        int charCount = 0;
        int wordCount = 0;
        try {
            while ((line = in.readLine()) != null) {
                lineCount++;
                charCount += line.length();
                String words[] = line.split("\\W");
                wordCount += words.length;
            } //while
            System.out.println("wordCount = " + wordCount);
            System.out.println("lineCount = " + lineCount);
            System.out.println("charCount = " + charCount);
        } // try
        catch (IOException e) {
            System.err.println("Error:" + e.getMessage());
        } //catch
    } //main
}
```

### Thuá»™c tÃ­nh vÃ  dÃ²ng tÃ¡c giáº£

```java
/* Added by Rick */
```

Há»‡ thá»‘ng quáº£n lÃ½ mÃ£ nguá»“n ghi nhá»› ráº¥t tá»‘t viá»‡c ai Ä‘Ã£ thÃªm gÃ¬, thÃªm khi nÃ o,.. KhÃ´ng cáº§n pháº£i lÃ m Ã´ nhiá»…m code báº±ng nhá»¯ng dÃ²ng tÃ¡c giáº£. Báº¡n cÃ³ thá»ƒ nghÄ© ráº±ng nhá»¯ng comment nhÆ° váº­y sáº½ há»¯u Ã­ch, ngÆ°á»i khÃ¡c sáº½ biáº¿t ai Ä‘Ã£ lÃ m viá»‡c vá»›i pháº§n code Ä‘Ã³. NhÆ°ng thá»±c táº¿ lÃ  chÃºng cÃ³ xu hÆ°á»›ng á»Ÿ láº¡i Ä‘Ã³ trong nhiá»u nÄƒm, vÃ  ngÃ y cÃ ng Ã­t chÃ­nh xÃ¡c, vÃ  Ã­t liÃªn quan.

Nháº¯c láº¡i láº§n ná»¯a, há»‡ thá»‘ng quáº£n lÃ½ mÃ£ nguá»“n lÃ  nÆ¡i tá»‘t hÆ¡n Ä‘á»ƒ lÆ°u nhá»¯ng thÃ´ng tin nÃ y.

### Comment-hÃ³a code

Comment-hÃ³a code (chuyá»ƒn code thÃ nh comment) lÃ  má»™t trong nhá»¯ng thÃ³i quen khiáº¿n láº­p trÃ¬nh viÃªn dá»… bá»‹ ghÃ©t nháº¥t. Äá»«ng lÃ m viá»‡c Ä‘Ã³!

```java
InputStreamResponse response = new InputStreamResponse();
response.setBody(formatter.getResultStream(), formatter.getByteCount());
// InputStream resultsStream = formatter.getResultStream();
// StreamReader reader = new StreamReader(resultsStream);
// response.setContent(reader.read(formatter.getByteCount()));
```

Nhá»¯ng ngÆ°á»i khÃ¡c khi tháº¥y comment dáº¡ng nÃ y sáº½ khÃ´ng Ä‘á»§ dÅ©ng cáº£m Ä‘á»ƒ xÃ³a nÃ³. Há» nghÄ© ráº±ng nÃ³ náº±m Ä‘Ã³ vÃ¬ má»™t lÃ½ do nÃ o Ä‘Ã³, vÃ  cháº¯c háº³n lÃ  nÃ³ quan trá»ng.

HÃ£y xem xÃ©t Ä‘oáº¡n code dÆ°á»›i Ä‘Ã¢y:

```java
this.bytePos = writeBytes(pngIdBytes, 0);
//hdrPos = bytePos;
writeHeader();
writeResolution();
//dataPos = bytePos;
if (writeImageData()) {
    writeEnd();
    this.pngBytes = resizeByteArray(this.pngBytes, this.maxPos);
}
else {
    this.pngBytes = null;
}
return this.pngBytes;
```

Táº¡i sao láº¡i cÃ³ hai dÃ²ng code bá»‹ chuyá»ƒn thÃ nh comment? ChÃºng cÃ³ quan trá»ng khÃ´ng? CÃ³ pháº£i chÃºng Ä‘á»ƒ láº¡i má»™t lá»i nháº¯c cho má»™t sá»‘ thay Ä‘á»•i sáº¯p xáº£y ra? Hay chÃºng chá»‰ lÃ  má»™t dÃ²ng comment Ä‘Ã£ tá»“n táº¡i tá»« nhiá»u nÄƒm trÆ°á»›c vÃ  Ä‘Æ¡n giáº£n lÃ  khÃ´ng ai thÃ¨m dá»n dáº¹p?

ÄÃ£ tá»«ng cÃ³ má»™t thá»i gian, vÃ o nhá»¯ng nÄƒm 60, khi nhá»¯ng comment dáº¡ng nÃ y cÃ³ Ã­ch. NhÆ°ng hiá»‡n táº¡i há»‡ thá»‘ng quáº£n lÃ½ mÃ£ nguá»“n Ä‘ang vÃ  sáº½ tiáº¿p tá»¥c hoáº¡t Ä‘á»™ng tá»‘t. Há»‡ thá»‘ng quáº£n lÃ½ mÃ£ nguá»“n sáº½ nhá»› code cho tÃ´i vÃ  báº¡n, vÃ  cháº¯c cháº¯n khÃ´ng cÃ³ lÃ½ do gÃ¬ Ä‘á»ƒ comment-hÃ³a má»™t dÃ²ng code. HÃ£y xÃ³a dÃ²ng code Ä‘Ã³, chÃºng ta sáº½ khÃ´ng bá»‹ máº¥t nÃ³. TÃ´i thá» Ä‘áº¥y.

### HTML comment

ÄÆ°a HTML vÃ o comment lÃ  má»™t hÃ nh Ä‘á»™ng xÃºc pháº¡m láº­p trÃ¬nh viÃªn. NhÆ° cÃ¡ch mÃ  báº¡n tháº¥y bÃªn dÆ°á»›i. NÃ³ lÃ m comment khÃ³ Ä‘á»c trá»±c tiáº¿p nhÆ°ng láº¡i dá»… Ä‘á»c hÆ¡n trÃªn trÃ¬nh soáº¡n tháº£o hoáº·c IDE khÃ¡c. Náº¿u cÃ¡c comment Ä‘Æ°á»£c trÃ­ch xuáº¥t bá»Ÿi cÃ´ng cá»¥ vÃ  hiá»ƒn thá»‹ nhÆ° má»™t trang web, viá»‡c tÃ´ váº½ cho comment báº±ng HTML lÃ  trÃ¡ch nhiá»‡m cá»§a cÃ´ng cá»¥ Ä‘Ã³, chá»© khÃ´ng pháº£i cá»§a láº­p trÃ¬nh viÃªn.

```java
/**
 * Task to run fit tests.
 * This task runs fitnesse tests and publishes the results.
 * <p/>
 * <pre>
 * Usage:
 * &lt;taskdef name=&quot;execute-fitnesse-tests&quot;
 * classname=&quot;fitnesse.ant.ExecuteFitnesseTestsTask&quot;
 * classpathref=&quot;classpath&quot; /&gt;
 * OR
 * &lt;taskdef classpathref=&quot;classpath&quot;
 * resource=&quot;tasks.properties&quot; /&gt;
 * <p/>
 * &lt;execute-fitnesse-tests
 * suitepage=&quot;FitNesse.SuiteAcceptanceTests&quot;
 * fitnesseport=&quot;8082&quot;
 * resultsdir=&quot;${results.dir}&quot;
 * resultshtmlpage=&quot;fit-results.html&quot;
 * classpathref=&quot;classpath&quot; /&gt;
 * </pre>
 */
```

### ThÃ´ng tin phi táº­p trung

Náº¿u báº¯t buá»™c pháº£i viáº¿t má»™t comment, hÃ£y Ä‘áº£m báº£o ráº±ng nÃ³ giáº£i thÃ­ch cho pháº§n code gáº§n nÃ³ nháº¥t. Äá»«ng cung cáº¥p thÃ´ng tin cá»§a toÃ n bá»™ há»‡ thá»‘ng trong má»™t comment cá»¥c bá»™. Xem xÃ©t vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y: DÃ¹ thá»«a tháº£i nhÆ°ng nÃ³ cung cáº¥p thÃ´ng tin vá» cá»•ng máº·c Ä‘á»‹nh. Tuy nhiÃªn hÃ m nÃ y láº¡i hoÃ n toÃ n khÃ´ng cÃ³ quyá»n kiá»ƒm soÃ¡t cá»•ng máº·c Ä‘á»‹nh. Comment khÃ´ng mÃ´ táº£ cho hÃ m, mÃ  mÃ´ táº£ má»™t pháº§n nÃ o Ä‘Ã³ trong há»‡ thá»‘ng. Táº¥t nhiÃªn, khÃ´ng cÃ³ gÃ¬ Ä‘áº£m báº£o comment nÃ y sáº½ Ä‘Æ°á»£c thay Ä‘á»•i khi code mÃ  nÃ³ mÃ´ táº£ thay Ä‘á»•i.

```java
/**
 * Port on which fitnesse would run. Defaults to <b>8082</b>.
 *
 * @param fitnessePort
 */
public void setFitnessePort(int fitnessePort)
{
    this.fitnessePort = fitnessePort;
}
```

### QuÃ¡ nhiá»u thÃ´ng tin

Äá»«ng Ä‘Æ°a cÃ¡c cuá»™c tháº£o luáº­n hoáº·c mÃ´ táº£ khÃ´ng liÃªn quan vÃ o comment cá»§a báº¡n. Comment dÆ°á»›i Ä‘Ã¢y Ä‘Æ°á»£c láº¥y ra tá»« má»™t module cÃ³ chá»©c nÄƒng mÃ£ hÃ³a vÃ  giáº£i mÃ£ base64. Má»™t ngÆ°á»i nÃ o Ä‘Ã³ cÃ³ thá»ƒ Ä‘á»c code nÃ y mÃ  khÃ´ng cáº§n nhá»¯ng thÃ´ng tin phá»©c táº¡p tá»« comment.

```java
/*
 RFC 2045 - Multipurpose Internet Mail Extensions (MIME)
 Part One: Format of Internet Message Bodies
 section 6.8. Base64 Content-Transfer-Encoding
 The encoding process represents 24-bit groups of input bits as output
 strings of 4 encoded characters. Proceeding from left to right, a
 24-bit input group is formed by concatenating 3 8-bit input groups.
 These 24 bits are then treated as 4 concatenated 6-bit groups, each
 of which is translated into a single digit in the base64 alphabet.
 When encoding a bit stream via the base64 encoding, the bit stream
 must be presumed to be ordered with the most-significant-bit first.
 That is, the first bit in the stream will be the high-order bit in
 the first 8-bit byte, and the eighth bit will be the low-order bit in
 the first 8-bit byte, and so on.
 */
```

### Má»‘i quan há»‡ khÃ³ hiá»ƒu

Sá»± káº¿t ná»‘i giá»¯a comment vÃ  code mÃ  nÃ³ mÃ´ táº£ nÃªn rÃµ rÃ ng. Náº¿u báº¡n gáº·p khá»• sá»Ÿ khi pháº£i viáº¿t comment, Ã­t nháº¥t báº¡n cÅ©ng muá»‘n ngÆ°á»i khÃ¡c nhÃ¬n vÃ o comment vÃ  hiá»ƒu nhá»¯ng gÃ¬ nÃ³ Ä‘ang nÃ³i vá» code.

Xem xÃ©t vÃ­ dá»¥ sau:

```java
/*
 * start with an array that is big enough to hold all the pixels
 * (plus filter bytes), and an extra 200 bytes for header info
 * báº¯t Ä‘áº§u vá»›i má»™t máº£ng Ä‘á»§ lá»›n Ä‘á»ƒ chá»©a táº¥t cáº£ cÃ¡c pixel
 * (cá»™ng vá»›i má»™t sá»‘ byte cá»§a bá»™ lá»c), vÃ  thÃªm 200 byte cho tiÃªu Ä‘á»
 */
 this.pngBytes = new byte[((this.width + 1) * this.height * 3) + 200];
```

Má»™t byte cá»§a bá»™ lá»c nghÄ©a lÃ  gÃ¬? NÃ³ cÃ³ liÃªn quan gÃ¬ Ä‘áº¿n +1 khÃ´ng? Hay \*3? Hay cáº£ hai? Táº¡i sao láº¡i lÃ  giÃ¡ trá»‹ 200 mÃ  khÃ´ng pháº£i giÃ¡ trá»‹ khÃ¡c? Má»¥c Ä‘Ã­ch cá»§a comment lÃ  Ä‘á»ƒ giáº£i thÃ­ch code, khÃ´ng pháº£i giáº£i thÃ­ch chÃ­nh nÃ³. Tháº­t Ä‘Ã¡ng tiáº¿c khi comment láº¡i cáº§n má»™t lá»i giáº£i thÃ­ch cho riÃªng mÃ¬nh.

### Comment lÃ m tiÃªu Ä‘á» cho hÃ m

CÃ¡c hÃ m ngáº¯n khÃ´ng cáº§n nhiá»u mÃ´ táº£. Äáº·t má»™t cÃ¡i tÃªn Ä‘á»§ tá»‘t cho hÃ m thÆ°á»ng tá»‘t hÆ¡n viá»‡c Ä‘áº·t má»™t comment á»Ÿ trÆ°á»›c hÃ m Ä‘Ã³.

### Javadocs trong code khÃ´ng cÃ´ng khai

[...] Viá»‡c táº¡o cÃ¡c trang javadoc cho cÃ¡c lá»›p vÃ  cÃ¡c hÃ m trong há»‡ thá»‘ng thÆ°á»ng khÃ´ng há»¯u Ã­ch, vÃ  thá»§ tá»¥c bá»• sung cÃ¡c comment khÃ´ng khÃ¡c gÃ¬ sá»± lá»™n xá»™n vÃ  lÃ m máº¥t thá»i gian.

### VÃ­ dá»¥

TÃ´i Ä‘Ã£ viáº¿t module trong Listing 4-7 cho _XP Immersion_ Ä‘áº§u tiÃªn. NÃ³ Ä‘Æ°á»£c dá»± Ä‘á»‹nh lÃ  má»™t vÃ­ dá»¥ vá» phong cÃ¡ch viáº¿t code xáº¥u vÃ  comment xáº¥u. Kent Back sau Ä‘Ã³ Ä‘Ã£ tÃ¡i cáº¥u trÃºc code nÃ y láº¡i dÆ°á»›i hÃ¬nh thá»©c dá»… chá»‹u hÆ¡n trÆ°á»›c máº·t hÃ ng tÃ¡ sinh viÃªn. Sau Ä‘Ã³ tÃ´i Ä‘Ã£ Ä‘iá»u chá»‰nh chÃºng Ä‘á»ƒ phÃ¹ há»£p vá»›i quyá»ƒn sÃ¡ch _Agile Software Development, Principles, Patterns, and Practices_ vÃ  bÃ i viáº¿t _Craftsman_ Ä‘áº§u tiÃªn Ä‘Ã£ Ä‘Æ°á»£c xuáº¥t báº£n trÃªn táº¡p chÃ­ _Software Development_.

Äiá»u tÃ´i cáº£m tháº¥y thÃº vá»‹ trong module nÃ y lÃ , Ä‘Ã£ cÃ³ lÃºc nhiá»u ngÆ°á»i trong chÃºng tÃ´i xem nÃ³ lÃ  má»™t _tÃ i liá»‡u tham kháº£o hay_. CÃ²n bÃ¢y giá» chÃºng ta xem nÃ³ lÃ  má»™t má»› lá»™n xá»™n. HÃ£y xem cÃ³ bao nhiÃªu váº¥n Ä‘á» vá» comment mÃ  báº¡n cÃ³ thá»ƒ tÃ¬m tháº¥y.

| Listing 4-7 **GeneratePrimes.java** |
| --- |
```java
/**
 * This class Generates prime numbers up to a user specified
 * maximum. The algorithm used is the Sieve of Eratosthenes.
 * <p>
 * Eratosthenes of Cyrene, b. c. 276 BC, Cyrene, Libya --
 * d. c. 194, Alexandria. The first man to calculate the
 * circumference of the Earth. Also known for working on
 * calendars with leap years and ran the library at Alexandria.
 * <p>
 * The algorithm is quite simple. Given an array of integers
 * starting at 2. Cross out all multiples of 2. Find the next
 * uncrossed integer, and cross out all of its multiples.
 * Repeat untilyou have passed the square root of the maximum
 * value.
 *
 * @author Alphonse
 * @version 13 Feb 2002 atp
 */
import java.util.*;
public class GeneratePrimes
{
    /**
    * @param maxValue is the generation limit.
    */
    public static int[] generatePrimes(int maxValue)
    {
        if (maxValue >= 2) // the only valid case
        {
            // declarations
            int s = maxValue + 1; // size of array
            boolean[] f = new boolean[s];
            int i;
            // initialize array to true.
            for (i = 0; i < s; i++)
            f[i] = true;
            // get rid of known non-primes
            f[0] = f[1] = false;
            // sieve
            int j;
            for (i = 2; i < Math.sqrt(s) + 1; i++)
            {
                if (f[i]) // if i is uncrossed, cross its multiples.
                {
                    for (j = 2 * i; j < s; j += i)
                    f[j] = false; // multiple is not prime
                }
            }
            // how many primes are there?
            int count = 0;
            for (i = 0; i < s; i++)
            {
                if (f[i])
                count++; // bump count.
            }
            int[] primes = new int[count];
            // move the primes into the result
            for (i = 0, j = 0; i < s; i++)
            {
                if (f[i]) // if prime
                primes[j++] = i;
            }
            return primes; // return the primes
        }
        else // maxValue < 2
        return new int[0]; // return null array if bad input.
    }
}
```

Trong Listing 4-8, báº¡n cÃ³ thá»ƒ tháº¥y má»™t phiÃªn báº£n Ä‘Æ°á»£c tÃ¡i cáº¥u trÃºc cá»§a module trÃªn. ChÃº Ã½ ráº±ng viá»‡c sá»­ dá»¥ng comment Ä‘Æ°á»£c háº¡n cháº¿ tá»‘i Ä‘a. Chá»‰ cÃ³ hai comment trong toÃ n bá»™ module vÃ  chÃºng Ä‘á»u há»£p lÃ½.

| Listing 4-8 **GeneratePrimes.java** |
| --- |
```java
/**
 * This class Generates prime numbers up to a user specified
 * maximum. The algorithm used is the Sieve of Eratosthenes.
 * Given an array of integers starting at 2:
 * Find the first uncrossed integer, and cross out all its
 * multiples. Repeat until there are no more multiples
 * in the array.
 */
public class PrimeGenerator
{
    private static boolean[] crossedOut;
    private static int[] result;
    public static int[] generatePrimes(int maxValue)
    {
        if (maxValue < 2)
            return new int[0];
        else
        {
            uncrossIntegersUpTo(maxValue);
            crossOutMultiples();
            putUncrossedIntegersIntoResult();
            return result;
        }
    }
    private static void uncrossIntegersUpTo(int maxValue)
    {
        crossedOut = new boolean[maxValue + 1];
        for (int i = 2; i < crossedOut.length; i++)
            crossedOut[i] = false;
    }
    private static void crossOutMultiples()
    {
        int limit = determineIterationLimit();
        for (int i = 2; i <= limit; i++)
            if (notCrossed(i))
                crossOutMultiplesOf(i);
    }
    private static int determineIterationLimit()
    {
        // Every multiple in the array has a prime factor that
        // is less than or equal to the root of the array size,
        // so we don't have to cross out multiples of numbers
        // larger than that root.
        double iterationLimit = Math.sqrt(crossedOut.length);
        return (int) iterationLimit;
    }
    private static void crossOutMultiplesOf(int i)
    {
        for (int multiple = 2*i;
                multiple < crossedOut.length;
                multiple += i)
            crossedOut[multiple] = true;
    }
    private static boolean notCrossed(int i)
    {
        return crossedOut[i] == false;
    }
    private static void putUncrossedIntegersIntoResult()
    {
        result = new int[numberOfUncrossedIntegers()];
        for (int j = 0, i = 2; i < crossedOut.length; i++)
            if (notCrossed(i))
                result[j++] = i;
    }
    private static int numberOfUncrossedIntegers()
    {
        int count = 0;
        for (int i = 2; i < crossedOut.length; i++)
            if (notCrossed(i))
                count++;
        return count;
    }
}
```

Tháº­t dá»… Ä‘á»ƒ chá»‰ ra comment Ä‘áº§u tiÃªn lÃ  dÆ° thá»«a vÃ¬ nÃ³ Ä‘á»c ráº¥t giá»‘ng hÃ m generatePrimes. Tuy nhiÃªn, tÃ´i nghÄ© ráº±ng comment giÃºp ngÆ°á»i Ä‘á»c dá»… tiáº¿p cáº­n thuáº­t toÃ¡n, vÃ¬ váº­y tÃ´i cÃ³ xu hÆ°á»›ng Ä‘á»ƒ láº¡i nÃ³.

Comment thá»© hai cháº¯c cháº¯n lÃ  cáº§n thiáº¿t. NÃ³ giáº£i thÃ­ch lÃ½ do Ä‘áº±ng sau viá»‡c sá»­ dá»¥ng giÃ¡ trá»‹ cÄƒn báº­c hai lÃ m giá»›i háº¡n vÃ²ng láº·p. TÃ´i khÃ´ng thá»ƒ tÃ¬m tháº¥y tÃªn biáº¿n Ä‘Æ¡n giáº£n hay cÃ¡ch thá»©c khÃ¡c Ä‘á»ƒ lÃ m rÃµ Ä‘iá»ƒm nÃ y. Máº·t khÃ¡c, viá»‡c sá»­ dá»¥ng cÄƒn báº­c hai cÃ³ thá»ƒ Ä‘á»ƒ láº¡i vÃ i váº¥n Ä‘á». TÃ´i cÃ³ tiáº¿t kiá»‡m Ä‘Æ°á»£c nhiá»u thá»i gian khi dÃ¹ng giÃ¡ trá»‹ cÄƒn báº­c hai lÃ m giá»›i háº¡n cho vÃ²ng láº·p hay khÃ´ng? Thá»i gian tiáº¿t kiá»‡m Ä‘Æ°á»£c cÃ³ nhiá»u hÆ¡n thá»i gian tÃ­nh cÄƒn báº­c hai hay khÃ´ng?

Hmm, tháº­t Ä‘Ã¡ng Ä‘á»ƒ suy nghÄ©. Sá»­ dá»¥ng cÄƒn báº­c hai lÃ m giá»›i háº¡n vÃ²ng láº·p Ä‘em láº¡i thá»a mÃ£n cho mÃ¡u hacker trong tÃ´i, nhÆ°ng tÃ´i khÃ´ng nghÄ© ngÆ°á»i khÃ¡c cÅ©ng cÃ³ mÃ¡u Ä‘Ã³. Má»™t comment á»Ÿ vá»‹ trÃ­ Ä‘Ã³ sáº½ giÃºp ngÆ°á»i Ä‘á»c dá»… dÃ ng hiá»ƒu nÃ³ hÆ¡n.

### Tham kháº£o

**[KP78]:** Kernighan and Plaugher, _The Elements of Programming Style_, 2d. ed., McGrawHill, 1978.